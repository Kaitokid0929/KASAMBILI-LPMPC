<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Shop - User</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: linear-gradient(to right, #e0eafc, #cfdef3);
            color: #333;
        }
        header {
            background: #4CAF50;
            color: white;
            padding: 15px;
            width: 100%;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .logo {
            font-size: 30px;
            font-weight: bold;
        }
        .container {
            width: 80%;
            margin: 20px auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        h2 {
            color: #4CAF50;
        }
        .product-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
        }
        .product {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            margin: 10px;
            width: calc(30% - 20px);
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .cart-button, .checkout-button, .submit-button {
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px;
            cursor: pointer;
            margin-top: 10px;
        }
        .cart-button {
            background: #f44336;
        }
        .cart-popup, .checkout-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border: 2px solid #4CAF50;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            width: 70%;
            max-height: 70%;
            overflow-y: auto;
            z-index: 1000;
            padding: 20px;
        }
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
    </style>
</head>
<body>

<header>
    <div class="logo">My Shop - User</div>
</header>

<div class="container">

    <h2>Products</h2>
    <div class="product-list" id="product-list"></div>

    <button class="cart-button" onclick="toggleCart()">View Cart (<span id="cart-count">0</span>)</button>

    <!-- Cart Popup -->
    <div class="cart-popup" id="cart-popup">
        <h2>Your Cart</h2>
        <div id="cart-items"></div>
        <p><strong>Total:</strong> ₱<span id="total-price">0.00</span></p>
        <button class="checkout-button" onclick="showCheckoutForm()">Checkout</button>
        <button class="checkout-button" onclick="toggleCart()">Close</button>
    </div>

    <!-- Checkout Form Popup -->
    <div class="checkout-popup" id="checkout-form">
        <h2>Checkout</h2>
        <div class="form-group">
            <label for="name">Full Name</label>
            <input type="text" id="name" required>
        </div>
        <div class="form-group">
            <label for="passbook-number">Passbook Number</label>
            <input type="text" id="passbook-number" required>
        </div>
        <div class="form-group">
            <label for="address">Address</label>
            <input type="text" id="address" required>
        </div>
        <div class="form-group">
            <label for="delivery-method">Pick-up or Deliver</label>
            <select id="delivery-method" onchange="toggleDateFields()">
                <option value="pickup">Pick-up</option>
                <option value="deliver">Deliver</option>
            </select>
        </div>
        <div class="form-group">
            <label for="date">Date (Pick-up/Delivery)</label>
            <input type="date" id="date" required>
        </div>
        <div class="form-group">
            <label for="payment-mode">Mode of Payment</label>
            <select id="payment-mode">
                <option value="cash">Cash</option>
                <option value="loan">Loan</option>
            </select>
        </div>
        <button class="submit-button" onclick="submitOrder()">Submit Order</button>
        <button class="checkout-button" onclick="toggleCheckoutForm()">Cancel</button>
    </div>

    <div class="overlay" id="overlay" onclick="toggleCart(); toggleCheckoutForm();"></div>

</div>

<footer>
    <p>&copy; 2024 My Shop</p>
</footer>

<script>
    let cart = [];

    // Load products from the admin database (could use an API)
    function loadProducts() {
        const products = JSON.parse(localStorage.getItem('products')) || [];
        const productList = document.getElementById('product-list');

        productList.innerHTML = '';
        products.forEach(product => {
            const productDiv = document.createElement('div');
            productDiv.className = 'product';
            productDiv.innerHTML = `
                <h3>${product.name}</h3>
                <p>₱${product.price.toFixed(2)}</p>
                <img src="${product.image}" alt="${product.name}" style="width: 100%; height: auto;">
                <button onclick="addToCart('${product.name}', ${product.price})">Add to Cart</button>
            `;
            productList.appendChild(productDiv);
        });
    }

    function addToCart(name, price) {
        const existingItem = cart.find(item => item.name === name);
        if (existingItem) {
            existingItem.quantity++;
        } else {
            cart.push({ name, price, quantity: 1 });
        }

        document.getElementById('cart-count').innerText = cart.length;
    }

    function toggleCart() {
        const cartPopup = document.getElementById('cart-popup');
        const overlay = document.getElementById('overlay');

        if (cartPopup.style.display === 'block') {
            cartPopup.style.display = 'none';
            overlay.style.display = 'none';
        } else {
            displayCartItems();
            cartPopup.style.display = 'block';
            overlay.style.display = 'block';
        }
    }

    function displayCartItems() {
        const cartItemsDiv = document.getElementById('cart-items');
        cartItemsDiv.innerHTML = '';

        let totalPrice = 0;
        cart.forEach(item => {
            totalPrice += item.price * item.quantity;
            cartItemsDiv.innerHTML += `
                <p>${item.name} - ₱${item.price.toFixed(2)} x ${item.quantity}</p>
            `;
        });

        document.getElementById('total-price').innerText = totalPrice.toFixed(2);
    }

    function toggleCheckoutForm() {
        const checkoutForm = document.getElementById('checkout-form');
        const overlay = document.getElementById('overlay');

        if (checkoutForm.style.display === 'block') {
            checkoutForm.style.display = 'none';
            overlay.style.display = 'none';
        } else {
            checkoutForm.style.display = 'block';
            overlay.style.display = 'block';
        }
    }

    function showCheckoutForm() {
        toggleCart();
        toggleCheckoutForm();
    }

    function submitOrder() {
        const name = document.getElementById('name').value;
        const passbookNumber = document.getElementById('passbook-number').value;
        const address = document.getElementById('address').value;
        const deliveryMethod = document.getElementById('delivery-method').value;
        const date = document.getElementById('date').value;
        const paymentMode = document.getElementById('payment-mode').value;

        const order = {
            name,
            passbookNumber,
            address,
            deliveryMethod,
            date,
            paymentMode,
            items: cart,
            total: document.getElementById('total-price').innerText
        };

        fetch('https://example.com/submit-order', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(order)
        }).then(response => {
            if (response.ok) {
                alert('Order submitted successfully!');
                cart = [];
                document.getElementById('cart-count').innerText = 0;
                toggleCheckoutForm();
            }
        }).catch(error => {
            alert('Failed to submit order. Please try again.');
        });
    }

    function toggleDateFields() {
        const deliveryMethod = document.getElementById('delivery-method').value;
        const dateLabel = document.querySelector('label[for="date"]');
        const dateInput = document.getElementById('date');

        if (deliveryMethod === 'pickup') {
            dateLabel.innerText = 'Pick-up Date';
        } else {
            dateLabel.innerText = 'Delivery Date';
        }
    }

    // Initialize products on page load
    window.onload = loadProducts;
</script>

</body>
</html>
